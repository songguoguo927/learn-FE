<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .dropArea {
            width: 400px;
            height: 400px;
            border: 1px dashed gray;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <!-- <form action="http://localhost:2233/upload" method="POST" enctype="multipart/form-data">
        用户：<input type="text" name="username" value="lee"><br/> 密码：
        <input type="password" name="password" value="123456"><br/>
        <input type="file" name="file" id=""><br/>
        <input type="submit" value="提交">
    </form> -->

    <!-- <form name="demoForm" id="demoForm" action="javascript: uploadAndSubmit()" method="POST" enctype="multipart/form-data">
        <p>Upload File: <input type="file" name="file" /></p>
        <input type="submit" value="Submit" />
        <div>Progessing (in Bytes):
            <span id="bytesRead"></span> / <span id="bytesTotal"></span>
        </div>
    </form> -->

    <!-- <div class="dropArea">

    </div> -->
    <!-- accept 属性并不会验证选中文件的类型. 他只是为开发这提供了一种引导用户做出期望行为的方式而已, 用户还是有办法绕过浏览器的限制., 在服务器端进行文件类型验证是必不可少的 -->
    <!-- 上传头像：<input type="file" id="avatar" name="avatar" accept="image/png, image/jpeg"> <br/> 上传视频： <input type="file" name="video" id=""> -->
    <input type="file" name="file" id="">
    <script>
        const input = document.querySelector('input[type="file"]')
        input.addEventListener('change', function(e) {
                console.log(input.files)
                const reader = new FileReader()

                reader.onload = function() {
                    //1对纯文本
                    // console.log(reader.result)
                    //2,对图像
                    const img = new Image()
                    img.src = reader.result
                    document.body.appendChild(img)
                }

                // reader.readAsText(input.files[0])//对文本文件 48直接打印出内容  ；对csv格式文件 
                //对图像
                reader.readAsDataURL(input.files[0])
            }, false)
            // function uploadAndSubmit() {
            //     var form = document.forms["demoForm"];

        //     if (form["file"].files.length > 0) {
        //         var file = form["file"].files[0];

        //         var reader = new FileReader()

        //         reader.onloadstart = function() {
        //             console.log("onloadstart 在读取开始触发")
        //             document.querySelector('#bytesTotal').textContent = file.size
        //         }

        //         reader.onprogress = function(p) { //该事件在读取Blob时触发。
        //             console.log("onprogress 在读取进行中触发")
        //             document.querySelector('#bytesRead').textContent = p.loaded
        //         }

        //         reader.onloadend = function() {
        //                 console.log('这个事件在读取结束后，成功或失败都会触发')
        //                 reader.error && console.log(reader.error)
        //                 document.querySelector('#bytesRead').textContent = file.size

        //                 // 构造 XMLHttpRequest 对象，发送文件 Binary 数据
        //                 var xhr = new XMLHttpRequest();
        //                 xhr.open("POST", 'http://localhost:2233/upload')
        //                     // xhr.overrideMimeType("application/octet-stream");
        //                 xhr.send(reader.result);

        //                 xhr.onreadystatechange = function() {
        //                     if (xhr.readyState == 4) {
        //                         if (xhr.status == 200) {
        //                             console.log("上传完成")
        //                             console.log("response:" + xhr.responseText)
        //                         }
        //                     }
        //                 }
        //             }
        //             // reader.readAsArrayBuffer(file)
        //             // reader.readAsBinaryString(file)
        //         reader.readAsText(file)
        //     } else {
        //         alert("请选择文件")
        //     }

        // }
    </script>
</body>

</html>